# Прогнозирование заказов такси

## Цель проекта

Целью данного проекта является разработка модели для прогнозирования количества заказов такси на следующий час. Это поможет компании более эффективно привлекать водителей в периоды пиковой нагрузки.
Ключевая метрика для оценки качества модели — RMSE на тестовой выборке, которая не должна превышать 48.

## Описание данных

Проект использует исторические данные о заказах такси в аэропортах.

*   **Файл:** `taxi.csv`
*   **Столбцы:**
    *   `datetime`: дата и время заказа такси.
    *   `num_orders`: количество заказов.
*   **Период данных:** С 1 марта по 31 августа 2018 года.

## Технологический стек

*   **Python**
*   **Pandas**: Для загрузки, обработки и манипуляции данными, включая ресемплирование временных рядов.
*   **NumPy**: Для численных операций.
*   **Matplotlib & Seaborn**: Для визуализации данных и результатов анализа.
*   **Scikit-learn**: Для разделения данных на выборки, обучения моделей и оценки метрик.
*   **Statsmodels**: Для декомпозиции временных рядов и выявления сезонности и тренда.

## Содержание проекта

### 1. Загрузка и предобработка данных

*   Загрузка исходного датасета.
*   Преобразование колонки `datetime` в формат даты/времени и установка ее в качестве индекса датафрейма.
*   Проверка временного ряда на монотонность и отсутствие полных дубликатов.
*   Агрегация данных с 10-минутного интервала до 1 часа путем суммирования количества заказов.

### 2. Исследовательский анализ данных (EDA)

*   Анализ временного диапазона доступных данных (март-август 2018 года).
*   Декомпозиция временного ряда с использованием `seasonal_decompose` для выявления тренда, сезонности и остатка.
*   **Ключевые выводы EDA:**
    *   **Ежедневная сезонность:** Пики заказов приходятся на полночь (00:00) и 16:00. Минимальное количество заказов наблюдается в утренние часы (5-7 утра).
    *   **Общий тренд:** Наблюдается постепенный рост количества заказов с марта по август 2018 года, достигая максимума в августе.
*   Визуализация временного ряда с помощью скользящего среднего для сглаживания и выявления общих тенденций.

### 3. Подготовка признаков и обучение моделей

*   **Создание новых признаков:** Сгенерированы дополнительные признаки на основе индекса `datetime`: `month` (месяц), `day` (день), `dayofweek` (день недели), `hour` (час).
*   **Лаговые признаки:** Добавлены смещенные значения целевого признака (`num_orders`) в качестве лаговых признаков (от `lag_1` до `lag_7`) для учета исторической информации.
*   **Скользящее среднее:** Введен признак `rolling_mean`, представляющий собой скользящее среднее количество заказов за последние 5 часов (смещенное на 1 час).
*   Данные разделены на обучающую (90%) и тестовую (10%) выборки с сохранением хронологического порядка (`shuffle=False`).
*   **Выбор и обучение моделей:** Рассмотрены три модели для прогнозирования: `LinearRegression`, `DecisionTreeRegressor`, `RandomForestRegressor`.
*   **Подбор гиперпараметров:** Для оптимизации моделей и предотвращения переобучения использовался `RandomizedSearchCV` со стратегией кросс-валидации `TimeSeriesSplit` и метрикой оценки `neg_root_mean_squared_error`.

### 4. Результаты

*   **Лучшая модель по результатам `RandomizedSearchCV` на обучающей выборке:** `RandomForestRegressor`.
*   **Параметры лучшей модели:** `min_samples_leaf=2`, `min_samples_split=5`, `max_features='auto'`, `random_state=42`.
*   **Среднее значение RMSE на обучающей выборке:** ~25.58.
*   **Прогноз и оценка на тестовой выборке:**
    *   Среднее предсказанное количество заказов на тестовой выборке: ~119.28.
    *   **Итоговая метрика RMSE на тестовой выборке: 44.95.**

## Общий вывод

Все поставленные задачи проекта были успешно выполнены. Была разработана модель для прогнозирования заказов такси, которая демонстрирует хорошее качество предсказаний. Выбранная модель `RandomForestRegressor` с подобранными гиперпараметрами показала **RMSE 44.95** на тестовой выборке, что соответствует целевому требованию (не более 48).

Исследовательский анализ данных позволил выявить важные закономерности в поведении заказов такси, включая ярко выраженную ежедневную и общую сезонность, которая была эффективно использована при создании признаков для обучения модели. Полученные результаты могут быть использованы компанией для более точного планирования ресурсов и оптимизации работы водителей.
